第５章　引用类型


引用类型的值（对象）是引用类型的一个实例。在ECMAScript 中，引用类型是一种数据结构，
用于将数据和功能组织在一起。它也常被称为类
引用类型有时候页被称为对象定义


对象是某个特定引用类型的实例。新对象是使用new操作符后跟一个构造函数来创建的。构造函数本身就是一个函数，
只不过该函数是处于创建新对象的目的而定义的

var person = new Object();

上面代码创建了Object引用类型的一个新实例，然后把该实例保存在变量person中。使用的构造函数是Object,它
只为新对象定义了默认的属性和方法。ECMAscript提供了很多原生引用类型（例如Object）,以便开发人员用以实现常见的
计算任务



５．１　Object类型
目前看到的大多数引用类型值都是Object类型的实例；而且，object也是ECMAScript中使用使用最多的一个类型
。对于在应用程序中的存储和传输数据而言，它们确实是理想的选择。

创建Object实例的方式有多种。
1.第一种是使用new操作符后跟object构造函数。

var person = new Object();
person.name = "Karson";
person.age = '29;
2. 第二种方式是使用对象字面量表示法。对象字面量是对象定义的一种简写形式，目的在于简化创建包含
大量属性的对象的过长

person对象

var person = {
name:"Karson",
age:29
}

在使用对象字面量语法时，属性名也可以使用字符串

var person = {
'name':'Karson',
'age':29,
5:true}

另外，使用对象字面量语法时，如果留空其花括号，则可以定义只包含默认属性和方法的对象

var person = {};  // 与new Object()相同
person.name = "Karson";
person.age  = 29;

在通过对象字面量定义对象时，实际上不会调用Object构造函数
实际上，对象字面量也是向函数传递大量可选参数的首选方式

function displayInfo(args){
var output = "";
if (typeof args.name == "string"){
output += "Name:" + args.name + "\n";
}
if (typeof args.age == "number")
{output += "Age:" + args.age + "\n";}
alert(output);}


displayInfo(
{
 name:'Karson',
  age:29});
displayInfo({
name:"Greg"});

传递参数的模式最适合需要向函数传入大量可选参数的情形。最好的做好是对那些必需值使用命名参数，而
使用对象字面量来封装多个可选参数

一般来说，访问对象属性时使用的都是点表示法，这也是很多面向对象语言中通用的语法，不过，在js也可以
使用方括号表示法来访问对象的属性。在使用方括号语法时，应该将要访问的属性以字符串的形式放在方括号中
alert(person['name']);
alert(person.name);
两种结果相同，但是方括号语法的主要有点是可以通过变量来访问属性

var propertyName = "name";
alert(person[propertyName]);
如果属性名中包含会导致语法错误的字符，或属性名使用的是关键字或保留字，也可以使用方括号表示法
通常，除非必须使用变量来访问属性，否则建议使用点表示法。

５．２　Array()类型

ECMAScript数组的每一项可以保存任何类型的数据，可以用数组的第一个位置来保存字符串，用第二位置
来保存数值，用第三个位置来保存对象，而且ECMAScript数组的大小可以是动态调整的，即可以随着数据的添加
自动增长以容纳新增数据。
创建数组的基本方式有两种：
１．使用Array构造函数
var colors = new Array();

如果预先知道数组要保存的项目数量，也可以给构造函数传递该数量，而该数量会自耦东变成length属性的值

var colors = new Array(20);

也可以向Array构造函数传递数组中应该包含的项

var colors = new Array("Red","blue","green");

当然，给构造函数传递一个值也可以创造数组。因为如果传递的是数值，则会按照该数组创建包含给定项数的数组；
而如果传递的是其他类型的参数，则会创建包含那个值的只有一项的数组

var colors = new Array(3);
var names = new Array('gree');
创建数组的第二个方式是使用数组字面量表示法。数组字面量由一对包含数组项的方括号表示，多个数组项之间
以逗号各科

var colors = ['red','blue','green'];
var names = [];
var values = [1,2,];
var options = [,,,,];
与对象一样，在使用数组字面量表示法时，也不会调用Array构造函数

在读取和设置数组的值时，要使用方括号并提供相应值的基于０的数字索引
数组的项数保存在其length属性中，这个属性始终会返回０或更大的值

数组的length属性很有特点－－－－它不是只读的。因此，通过设置这个属性，可以从数组
的末尾移除项或向数组中添加新项
利用length属性也可以方便地在数组末尾添加新项。由于数组最后一项的索引始终是length －１，
因此下一个新项的位置就是length.

5.2.1  检测数组

对于一个网页，或一个全局作用域而言，使用instanceof操作符就能得到满意的结果

if (value instanceof Array){
//对数组执行某些操作};
instanceof操作符的问题在于，它假定单一的全局执行环境。如果网页中包含多个框架，那实际上
就存在两个以上不同的全局执行环境，从而存在两个以上的不同版本的Array构造函数。
解决这个，使用Array.isArray()方法。这个方法的目的是最终确定某个值是不是数组，而不管
它在哪个全局执行环境中创建
if (Array.isArray(value)){
//对数组执行某些操作}；

５．２．２　转换方法
所有对象都具有toLocaleString(),toString(),valueOf()方法，其中调用数组的toString（）方法
会返回由数组中每个值的字符串形式拼接而成的一个以逗号分隔的字符串。而调用valueOf()返回的还是数组。
实际上，为了这个字符串会调用数组每一项的toString()方法

alert()要接收字符串参数，toLocaleString()方法经常会返回与toString()和valueOf()方法相同
的值，当调用数组的toLocaleString()方法时，它也会创建一个数组值的以逗号分隔的字符串。而后者取得
每一项的值，调用的是每一项的toLocaleString()方法，而不是toString()方法。
数组继承的toLocaleString(),toString(),valuesOf()方法。在默认情况下都会以逗号分隔的字符串
的形式返回数组。而如果使用join(),则可以使用不同的分隔符来构建这个字符串。join()方法只接收一个参数，
即用做分隔符的字符串，然后返回包含所有数组的字符串。

如果数组中的每一项的值是null或underfined,那么该值在join(),toLocale-String(),toString()
和valueOf()方法返回的结果中以空字符串表示

５．２．３　栈方法

ECMAScript数组也提供了一个让数组的行为类似于其他数据结构的方法。数组可以表现得像栈一样，后者是
一种可以限制插入和删除向的数据结构。栈是一种LIFO(last-in-first-out,后进先出)的数据结构
，也就是最新添加的项最早被移除。而栈中项的插入（叫做推入）和移除（叫做弹出）,只发生在一个
位置----栈的顶部。ECMAScript为专门提供了push(),pop()方法
push()方法可以接收任意数量的参数，把它们逐个添加到数组末尾，并返回修改后数组的长度。而pop()
方法则从数组末尾移除最后一项，减少数组的length值，然后返回移除的项

我们使用push()将两个字符串推入数组的末尾，并将返回的结果保存在变量count中，然后，再推入一个值，
而结果仍然保存在count中。
５．２．４　队列方法

栈数据结构的访问规则是LIFO(后进先出)，而队列数据结构的访问结构是FIFO(先进先出)。队列在列表
的末端添加项，从列表的前端移除项。由于push()是数组末端添加项的方法，因此要模拟队列只需要一个从数组
前端取得项的方法。实现这一操作的数组方法就是shift(),它能够移除数组中的第一个项并返回该项，同时将数组长度减１
．结合使用shift()和push(),可以像使用队列一样使用数组

ECMAScript还为数组提供了一个unshift()方法。unshift()和shift()的用途想法：
它能在数组前端添加任意个项并返回新数组的长度。因此，同时使用unshift()和pop()，可以
从相反的方向来模拟队列，即在数组的前端添加项，从数组末端移除项，

5.2.5 重排序方法

数组中已经存在两个可以直接用来重排序的方法：reverse(),sort()
注意，reverse()方法会对反转数组项的顺序

在默认情况下，sort()方法按升序排列数据项——即最小的值位于最前面，最大的值排在最后面。为了实现排序，sort()
方法会调用每个数组项的toString()转型方法，然后比较得到的字符串，以确定如何排序。即使数组中的每一项都是数值，
sort()方法比较的也是字符串
注意:sort()可以接收一个比较函数作为参数，以便我们指定哪个值位于哪个值的前面

比较函数接收两个参数，如果第一个参数应该位于第二个之前则返回一个负数，如果两个参数相等，则返回0.如果
第一个参数应该位于第二个之后则返回一个正数。
也可以比较降序排列。如果只是想反转数组原来的顺序，使用reverse()方法要更快一些

注意，reverse(),sort()方法的返回值是经过排序之后的数组。

对于数值类型或其valueOf()方法会返回数值类型的对象类型，可以使用一个更简单的比较函数。这个函数只要用
第二个值减去第一个值即可

function compare(v1,v2) {
return v1-v2;}

减法操作可以适当处理所有这些情况

５．２．６　操作方法

ECMAScript为操作已经包含在数组中的项提供了很多方法。其中，concat()可以基于当前数组中的所有项创建一个新数组。
这个方法会先创建当前数组的一个副本，然后将接收到的参数添加到这个副本的末尾，最后返回新构建的数组。在没有给concat()
方法传递参数的情况下，它只是复制当前数组并返回副本。如果传递给concat()方法的是一或多个数组，则该方法会将
这些数组中的每一项都添加到结果数组中。如果传递的值不是数组，这些值就会被简单地添加到结果数组的末尾

下一个方法是slice(),它能够基于当前数组中的一或多个项创建一个新数组。slice()方法可以接受一或两个参数，即要返回项
的起始和结束位置。在只有一个参数的情况下，slice()方法返回从该参数指定位置开始到当前数组末尾的所有项。如果有
两个参数，该方面返回起始和结束位置之间的项—————但不包括结束位置的项。注意，slice()方法不会影响原始数组。

如果slice()方法的参数中有一个参数，则用数组长度加上该数来确定相应的位置。例如，在一个包含５项的数组上调用slice(-2,-1)
与调用slice(3,4)得到的结果相同。


splice()方法：删除，插入，替换

splice()方法始终都会返回一个数组，该数组中包含从原始数组中的删除的项目(如果没有删除任何项，则返回一个空数组)


5.2.7 位置方法

ECMAScript5为数组实例添加了两个位置方法：indexOf(),lastIndexOf().这两个方法都接收两个参数：要查找的项和（可选的）
表示查找起点位置的索引。其中，indexOf()方法从数组的开头(位置０)开始向后查找,lastIndexOf()方法则从数组的末尾
开始向前查找

5.2.8 迭代方法　５个

ECMAScript５　为数组定义了５个迭代方法。每个方法都接收两个参数：要在每一项上运行的函数和(可选的)运行该函数的作用域对象———影响this的值。
传入这些方法中的函数会接收三个参数：数组项的值，该向在数组中的位置和数组对象本身。根据使用的方法不同，这个函数执行后的返回值可能
会也可能不会影响访问的返回值。
１．every(): 对数组中的每一项运行给定函数，如果该函数对每一项都返回true，则返回true
2.filert():对数组中的每一项运行给定函数，返回该函数会返回true的项组成的数组
3.forEach():对数组中的每一项运行给定函数，这个方法没有返回值
4.map():对数组中的每一项运行给定函数，返回每次函数调用的结果组成的数组
5.some():对数组中的每一项运行给定函数，如果该函数对任一项返回true，则返回true


